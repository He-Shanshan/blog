<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nginx高性能Web服务器 | Smile ^o^</title>
    <meta name="description" content="记录日常工作、学习的知识">
    <link rel="icon" href="/blog/img/彩虹.png">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/blog/assets/css/0.styles.00fe1ddf.css" as="style"><link rel="preload" href="/blog/assets/js/app.691678be.js" as="script"><link rel="preload" href="/blog/assets/js/2.ba034f29.js" as="script"><link rel="preload" href="/blog/assets/js/50.acb96b49.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.632bd915.js"><link rel="prefetch" href="/blog/assets/js/11.772f967c.js"><link rel="prefetch" href="/blog/assets/js/12.ff26e0aa.js"><link rel="prefetch" href="/blog/assets/js/13.1b8f9604.js"><link rel="prefetch" href="/blog/assets/js/14.9a7df919.js"><link rel="prefetch" href="/blog/assets/js/15.4d6a21fd.js"><link rel="prefetch" href="/blog/assets/js/16.666db653.js"><link rel="prefetch" href="/blog/assets/js/17.a797cfe4.js"><link rel="prefetch" href="/blog/assets/js/18.a045528b.js"><link rel="prefetch" href="/blog/assets/js/19.095e5a15.js"><link rel="prefetch" href="/blog/assets/js/20.0c5e41ec.js"><link rel="prefetch" href="/blog/assets/js/21.10c1c22c.js"><link rel="prefetch" href="/blog/assets/js/22.3d274259.js"><link rel="prefetch" href="/blog/assets/js/23.e9ce92b2.js"><link rel="prefetch" href="/blog/assets/js/24.c97a23b6.js"><link rel="prefetch" href="/blog/assets/js/25.1e14926e.js"><link rel="prefetch" href="/blog/assets/js/26.752bade9.js"><link rel="prefetch" href="/blog/assets/js/27.dc5a3e6b.js"><link rel="prefetch" href="/blog/assets/js/28.9d7929bc.js"><link rel="prefetch" href="/blog/assets/js/29.8bcca565.js"><link rel="prefetch" href="/blog/assets/js/3.a37b7841.js"><link rel="prefetch" href="/blog/assets/js/30.5d40f78a.js"><link rel="prefetch" href="/blog/assets/js/31.a7862089.js"><link rel="prefetch" href="/blog/assets/js/32.9ab020d3.js"><link rel="prefetch" href="/blog/assets/js/33.61af89c7.js"><link rel="prefetch" href="/blog/assets/js/34.ef67e138.js"><link rel="prefetch" href="/blog/assets/js/35.b8b72ed5.js"><link rel="prefetch" href="/blog/assets/js/36.ae5b409a.js"><link rel="prefetch" href="/blog/assets/js/37.e618ee46.js"><link rel="prefetch" href="/blog/assets/js/38.04806802.js"><link rel="prefetch" href="/blog/assets/js/39.8d9b9563.js"><link rel="prefetch" href="/blog/assets/js/4.0d191ff1.js"><link rel="prefetch" href="/blog/assets/js/40.04518f3a.js"><link rel="prefetch" href="/blog/assets/js/41.6bf1718b.js"><link rel="prefetch" href="/blog/assets/js/42.a3dfedee.js"><link rel="prefetch" href="/blog/assets/js/43.a8d95aa2.js"><link rel="prefetch" href="/blog/assets/js/44.3a12c49e.js"><link rel="prefetch" href="/blog/assets/js/45.d5d98979.js"><link rel="prefetch" href="/blog/assets/js/46.234ac3a9.js"><link rel="prefetch" href="/blog/assets/js/47.33679be5.js"><link rel="prefetch" href="/blog/assets/js/48.91dd4a4d.js"><link rel="prefetch" href="/blog/assets/js/49.278c8abb.js"><link rel="prefetch" href="/blog/assets/js/5.9b1c580e.js"><link rel="prefetch" href="/blog/assets/js/51.32188c4f.js"><link rel="prefetch" href="/blog/assets/js/52.ec8a6f44.js"><link rel="prefetch" href="/blog/assets/js/53.440af944.js"><link rel="prefetch" href="/blog/assets/js/54.85b002c5.js"><link rel="prefetch" href="/blog/assets/js/55.714cdb2c.js"><link rel="prefetch" href="/blog/assets/js/56.5a19f6c9.js"><link rel="prefetch" href="/blog/assets/js/57.03e1b8a3.js"><link rel="prefetch" href="/blog/assets/js/58.640f7bb7.js"><link rel="prefetch" href="/blog/assets/js/59.04ab8dd2.js"><link rel="prefetch" href="/blog/assets/js/6.b37cc082.js"><link rel="prefetch" href="/blog/assets/js/60.51243e5b.js"><link rel="prefetch" href="/blog/assets/js/61.869879d3.js"><link rel="prefetch" href="/blog/assets/js/62.19e9997a.js"><link rel="prefetch" href="/blog/assets/js/63.fa0d4e9e.js"><link rel="prefetch" href="/blog/assets/js/64.dcbb7569.js"><link rel="prefetch" href="/blog/assets/js/65.b0aee567.js"><link rel="prefetch" href="/blog/assets/js/66.c2239c63.js"><link rel="prefetch" href="/blog/assets/js/67.52c784b8.js"><link rel="prefetch" href="/blog/assets/js/68.39a7efed.js"><link rel="prefetch" href="/blog/assets/js/69.37845d77.js"><link rel="prefetch" href="/blog/assets/js/7.b1a72256.js"><link rel="prefetch" href="/blog/assets/js/70.eefd97a9.js"><link rel="prefetch" href="/blog/assets/js/71.ccd32287.js"><link rel="prefetch" href="/blog/assets/js/72.118662a5.js"><link rel="prefetch" href="/blog/assets/js/73.9d654570.js"><link rel="prefetch" href="/blog/assets/js/74.abbd1d57.js"><link rel="prefetch" href="/blog/assets/js/75.db0ef567.js"><link rel="prefetch" href="/blog/assets/js/76.2165a22a.js"><link rel="prefetch" href="/blog/assets/js/77.4ad54d5b.js"><link rel="prefetch" href="/blog/assets/js/78.53f09210.js"><link rel="prefetch" href="/blog/assets/js/79.6ebfbc85.js"><link rel="prefetch" href="/blog/assets/js/8.357c92c0.js"><link rel="prefetch" href="/blog/assets/js/80.78ce848e.js"><link rel="prefetch" href="/blog/assets/js/81.f420c368.js"><link rel="prefetch" href="/blog/assets/js/82.7c9a721b.js"><link rel="prefetch" href="/blog/assets/js/83.794915fc.js"><link rel="prefetch" href="/blog/assets/js/84.6a53c0fe.js"><link rel="prefetch" href="/blog/assets/js/85.2effe18f.js"><link rel="prefetch" href="/blog/assets/js/86.6a8b7025.js"><link rel="prefetch" href="/blog/assets/js/87.93ed8a37.js"><link rel="prefetch" href="/blog/assets/js/88.e446a59e.js"><link rel="prefetch" href="/blog/assets/js/9.b2e3f63a.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.00fe1ddf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/img/晴朗.png" alt="Smile ^o^" class="logo"> <span class="site-name can-hide">Smile ^o^</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="自学" class="dropdown-title"><span class="title">自学</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/guide/sourceCode/1.html" class="nav-link">框架源码相关内容</a></li><li class="dropdown-item"><!----> <a href="/blog/guide/stylesCode/3.html" class="nav-link">样式相关内容</a></li><li class="dropdown-item"><!----> <a href="/blog/guide/weixinCode/1.html" class="nav-link">小程序</a></li><li class="dropdown-item"><!----> <a href="/blog/guide/nodeCode/1.html" class="nav-link router-link-exact-active router-link-active">Node</a></li><li class="dropdown-item"><!----> <a href="/blog/guide/jsCommonCode/1.html" class="nav-link">JS专题</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工作" class="dropdown-title"><span class="title">工作</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/config/sourceCode/1.html" class="nav-link">webpack相关内容</a></li><li class="dropdown-item"><!----> <a href="/blog/config/stylesCode/1.html" class="nav-link">样式相关内容</a></li><li class="dropdown-item"><!----> <a href="/blog/config/jsCode/1.html" class="nav-link">其他</a></li><li class="dropdown-item"><!----> <a href="/blog/config/errorCode/1.html" class="nav-link">问题</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/language/English/1.html" class="nav-link">英语相关内容</a></li><li class="dropdown-item"><!----> <a href="/blog/language/Japanese/1.html" class="nav-link">日语相关内容</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/other/network/1.html" class="nav-link">网络相关内容</a></li><li class="dropdown-item"><!----> <a href="/blog/other/algorithm/1.html" class="nav-link">算法相关内容</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/He-Shanshan/blog.git" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="自学" class="dropdown-title"><span class="title">自学</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/guide/sourceCode/1.html" class="nav-link">框架源码相关内容</a></li><li class="dropdown-item"><!----> <a href="/blog/guide/stylesCode/3.html" class="nav-link">样式相关内容</a></li><li class="dropdown-item"><!----> <a href="/blog/guide/weixinCode/1.html" class="nav-link">小程序</a></li><li class="dropdown-item"><!----> <a href="/blog/guide/nodeCode/1.html" class="nav-link router-link-exact-active router-link-active">Node</a></li><li class="dropdown-item"><!----> <a href="/blog/guide/jsCommonCode/1.html" class="nav-link">JS专题</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工作" class="dropdown-title"><span class="title">工作</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/config/sourceCode/1.html" class="nav-link">webpack相关内容</a></li><li class="dropdown-item"><!----> <a href="/blog/config/stylesCode/1.html" class="nav-link">样式相关内容</a></li><li class="dropdown-item"><!----> <a href="/blog/config/jsCode/1.html" class="nav-link">其他</a></li><li class="dropdown-item"><!----> <a href="/blog/config/errorCode/1.html" class="nav-link">问题</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/language/English/1.html" class="nav-link">英语相关内容</a></li><li class="dropdown-item"><!----> <a href="/blog/language/Japanese/1.html" class="nav-link">日语相关内容</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/other/network/1.html" class="nav-link">网络相关内容</a></li><li class="dropdown-item"><!----> <a href="/blog/other/algorithm/1.html" class="nav-link">算法相关内容</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/He-Shanshan/blog.git" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Node原理基础API以及搭建静态服务器</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/guide/nodeCode/1.html" class="active sidebar-link">Nginx高性能Web服务器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/guide/nodeCode/1.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/blog/guide/nodeCode/1.html#选择nginx的理由" class="sidebar-link">选择Nginx的理由</a></li><li class="sidebar-sub-header"><a href="/blog/guide/nodeCode/1.html#安装与配置" class="sidebar-link">安装与配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/guide/nodeCode/1.html#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/blog/guide/nodeCode/1.html#nginx一些简单的命令" class="sidebar-link">nginx一些简单的命令</a></li><li class="sidebar-sub-header"><a href="/blog/guide/nodeCode/1.html#基本配置与优化" class="sidebar-link">基本配置与优化</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/guide/nodeCode/1.html#高级应用" class="sidebar-link">高级应用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/guide/nodeCode/1.html#rewrite-应用" class="sidebar-link">Rewrite 应用</a></li><li class="sidebar-sub-header"><a href="/blog/guide/nodeCode/1.html#负载均衡和反向代理" class="sidebar-link">负载均衡和反向代理</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nginx反响代理静态资源服务</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="nginx高性能web服务器"><a href="#nginx高性能web服务器" class="header-anchor">#</a> Nginx高性能Web服务器</h1> <h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <p>Nginx (engine x) 是一个高性能的HTTP和反向代理web服务器，同时也提供了IMAP/POP3/SMTP服务。它是由俄罗斯人Igor Sysoev（伊戈尔·塞索耶夫）编写的。<br>
Nginx是一款轻量级的Web 服务器，因它的稳定性、丰富的功能集、示例配置文件和低系统资源消耗而闻名。其特点是占用内存少，并发能力强，事实上Nginx的并发能力在同类型的web服务器中表现较好。<br>
在国内，已经有百度、京东、新浪、网易、腾讯、淘宝等多家网站使用Nginx作为Web服务器或反向代理服务器。</p> <h2 id="选择nginx的理由"><a href="#选择nginx的理由" class="header-anchor">#</a> 选择Nginx的理由</h2> <p>高并发连接    官方测试Nginx能够支持5万并发连接，在实际生产环境中可支撑2-4万并发连接数。<br>
消耗内存少     在同等硬件环境下，Nginx的处理能力相当于Apache的5-10倍。<br>
成本低廉         Nginx作为开源软件，可以免费使用，并且可用于商业用途。<br>
其它理由<br>
配置文件非常简单<br>
支持Rewrite重写规则<br>
内置健康检查功能<br>
节省带宽<br>
稳定性高<br>
...</p> <h2 id="安装与配置"><a href="#安装与配置" class="header-anchor">#</a> 安装与配置</h2> <h3 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h3> <blockquote><p>Mac如何安装nginx</p></blockquote> <p>由于mac自带brew，所以mac下安装nginx相对比较简单。
查看版本号：brew -v<br>
更新Homebrew : brew update<br>
搜索nginx：brew search nginx<br>
安装：brew install nginx<br>
查看nginx版本：nginx -v<br>
查看nginx信息：brew info nginx<br>
启动nginx：nginx<br>
访问网址：http://localhost:8080<br>
重启nginx：nginx -s reload</p> <pre><code>    sudo kill -QUIT 进程号
</code></pre> <p>1、查看brew版本</p> <pre><code>    brew -v
</code></pre> <p>2、更新Homebrew（如果版本比较老）</p> <pre><code>    brew update
</code></pre> <p>3.安装nginx</p> <pre><code>    brew search nginx
    brew install nginx
</code></pre> <p>4.安装完成查看版本</p> <pre><code>    nginx -v
</code></pre> <p>可通过以下命令查看nginx信息，如安装路径等</p> <pre><code>    brew info nginx
</code></pre> <p>启动nginx</p> <pre><code>    nginx
</code></pre> <p>重启</p> <pre><code>    nginx -s reload
</code></pre> <p>关闭</p> <pre><code>    sudo kill -QUIT 进程号
</code></pre> <p>输入</p> <pre><code>    ps -ef|grep nginx
</code></pre> <div class="language-vim line-numbers-mode"><pre class="language-vim"><code>  <span class="token number">501</span> <span class="token number">44255</span>     <span class="token number">1</span>   <span class="token number">0</span>  <span class="token number">6</span><span class="token punctuation">:</span><span class="token number">37</span>下午 <span class="token operator">?</span><span class="token operator">?</span>         <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00.00</span> nginx<span class="token punctuation">:</span> master process nginx
  <span class="token number">501</span> <span class="token number">44256</span> <span class="token number">44255</span>   <span class="token number">0</span>  <span class="token number">6</span><span class="token punctuation">:</span><span class="token number">37</span>下午 <span class="token operator">?</span><span class="token operator">?</span>         <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00.00</span> nginx<span class="token punctuation">:</span> worker process
  <span class="token number">501</span> <span class="token number">11397</span> <span class="token number">11355</span>   <span class="token number">0</span> 一<span class="token number">06</span>下午 ttys004    <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00.03</span> docker pull nginx
  <span class="token number">501</span> <span class="token number">11466</span> <span class="token number">11355</span>   <span class="token number">0</span> 一<span class="token number">06</span>下午 ttys004    <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00.02</span> docker pull nginx
  <span class="token number">501</span> <span class="token number">44266</span> <span class="token number">44114</span>   <span class="token number">0</span>  <span class="token number">6</span><span class="token punctuation">:</span><span class="token number">37</span>下午 ttys006    <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00.00</span> <span class="token keyword">grep</span> <span class="token operator">-</span><span class="token operator">-</span>color<span class="token operator">=</span>auto <span class="token operator">-</span><span class="token operator">-</span>exclude<span class="token operator">-</span><span class="token builtin">dir</span><span class="token operator">=</span><span class="token operator">.</span>bzr <span class="token operator">-</span><span class="token operator">-</span>exclude<span class="token operator">-</span><span class="token builtin">dir</span><span class="token operator">=</span>CVS <span class="token operator">-</span><span class="token operator">-</span>exclude<span class="token operator">-</span><span class="token builtin">dir</span><span class="token operator">=</span><span class="token operator">.</span>git <span class="token operator">-</span><span class="token operator">-</span>exclude<span class="token operator">-</span><span class="token builtin">dir</span><span class="token operator">=</span><span class="token operator">.</span>hg <span class="token operator">-</span><span class="token operator">-</span>exclude<span class="token operator">-</span><span class="token builtin">dir</span><span class="token operator">=</span><span class="token operator">.</span>svn nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>可以看到第一个是我们当前启动的nginx  名称也要nginx</p> <blockquote><p>关闭nginx，直接杀死进程</p></blockquote> <pre><code>    nginx -s stop
</code></pre> <p>设置环境变量</p> <pre><code>    vim /etc/profile
</code></pre> <p>shift+G到最后一行  更改模式为insert-&gt;i</p> <pre><code>    export NGINX_HOME=/usr/local/nginx
    export PATH=$PATH:$NGINX_HOME/sbin
</code></pre> <p>保存<br>
1.按下esc键<br>
2.输入&quot;:wq&quot;(保存退出)  输入&quot;:q!&quot;(不保存退出)</p> <p>刷新环境变量</p> <pre><code>    source /etc/profile
</code></pre> <p>重新启动nginx，查看他的进程</p> <pre><code>    nginx
    ps -ef|grep nginx
</code></pre> <div class="language-vim line-numbers-mode"><pre class="language-vim"><code>  <span class="token number">501</span> <span class="token number">45002</span>     <span class="token number">1</span>   <span class="token number">0</span>  <span class="token number">6</span><span class="token punctuation">:</span><span class="token number">58</span>下午 <span class="token operator">?</span><span class="token operator">?</span>         <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00.00</span> nginx<span class="token punctuation">:</span> master process nginx
  <span class="token number">501</span> <span class="token number">45003</span> <span class="token number">45002</span>   <span class="token number">0</span>  <span class="token number">6</span><span class="token punctuation">:</span><span class="token number">58</span>下午 <span class="token operator">?</span><span class="token operator">?</span>         <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00.00</span> nginx<span class="token punctuation">:</span> worker process
  <span class="token number">501</span> <span class="token number">11397</span> <span class="token number">11355</span>   <span class="token number">0</span> 一<span class="token number">06</span>下午 ttys004    <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00.03</span> docker pull nginx
  <span class="token number">501</span> <span class="token number">11466</span> <span class="token number">11355</span>   <span class="token number">0</span> 一<span class="token number">06</span>下午 ttys004    <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00.02</span> docker pull nginx
  <span class="token number">501</span> <span class="token number">45091</span> <span class="token number">44114</span>   <span class="token number">0</span>  <span class="token number">7</span><span class="token punctuation">:</span><span class="token number">00</span>下午 ttys006    <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">00.00</span> <span class="token keyword">grep</span> <span class="token operator">-</span><span class="token operator">-</span>color<span class="token operator">=</span>auto <span class="token operator">-</span><span class="token operator">-</span>exclude<span class="token operator">-</span><span class="token builtin">dir</span><span class="token operator">=</span><span class="token operator">.</span>bzr <span class="token operator">-</span><span class="token operator">-</span>exclude<span class="token operator">-</span><span class="token builtin">dir</span><span class="token operator">=</span>CVS <span class="token operator">-</span><span class="token operator">-</span>exclude<span class="token operator">-</span><span class="token builtin">dir</span><span class="token operator">=</span><span class="token operator">.</span>git <span class="token operator">-</span><span class="token operator">-</span>exclude<span class="token operator">-</span><span class="token builtin">dir</span><span class="token operator">=</span><span class="token operator">.</span>hg <span class="token operator">-</span><span class="token operator">-</span>exclude<span class="token operator">-</span><span class="token builtin">dir</span><span class="token operator">=</span><span class="token operator">.</span>svn nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>可以看到也正常启动起来了。<br>
mac中默认的路径</p> <pre><code>    /usr/local/etc/nginx/nginx.conf （配置文件路径）
</code></pre> <p>可以通过</p> <pre><code>    open /usr/local/etc/nginx/
</code></pre> <p>来查看配置文件所在的文件夹</p> <p>“html”的相对路径在哪里？此相对路径在编译时设置。可以通过命令检查路径：</p> <pre><code>      nginx -V
</code></pre> <div class="language-vim line-numbers-mode"><pre class="language-vim"><code>TLS SNI support enabled
configure arguments<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token operator">-</span>prefix<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>Cellar<span class="token operator">/</span>nginx<span class="token operator">/</span><span class="token number">1.17</span><span class="token operator">.</span>3_1 <span class="token operator">-</span><span class="token operator">-</span>sbin<span class="token operator">-</span><span class="token builtin">path</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>Cellar<span class="token operator">/</span>nginx<span class="token operator">/</span><span class="token number">1.17</span><span class="token operator">.</span>3_1<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>nginx <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span><span class="token keyword">cc</span><span class="token operator">-</span><span class="token keyword">opt</span><span class="token operator">=</span><span class="token string">'-I/usr/local/opt/pcre/include -I/usr/local/opt/openssl@1.1/include'</span> <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>ld<span class="token operator">-</span><span class="token keyword">opt</span><span class="token operator">=</span><span class="token string">'-L/usr/local/opt/pcre/lib -L/usr/local/opt/openssl@1.1/lib'</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token keyword">conf</span><span class="token operator">-</span><span class="token builtin">path</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>nginx<span class="token operator">.</span><span class="token keyword">conf</span> <span class="token operator">-</span><span class="token operator">-</span>pid<span class="token operator">-</span><span class="token builtin">path</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>var<span class="token operator">/</span>run<span class="token operator">/</span>nginx<span class="token operator">.</span>pid <span class="token operator">-</span><span class="token operator">-</span>lock<span class="token operator">-</span><span class="token builtin">path</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>var<span class="token operator">/</span>run<span class="token operator">/</span>nginx<span class="token operator">.</span>lock <span class="token operator">-</span><span class="token operator">-</span>http<span class="token operator">-</span>client<span class="token operator">-</span>body<span class="token operator">-</span>temp<span class="token operator">-</span><span class="token builtin">path</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>var<span class="token operator">/</span>run<span class="token operator">/</span>nginx<span class="token operator">/</span>client_body_temp <span class="token operator">-</span><span class="token operator">-</span>http<span class="token operator">-</span>proxy<span class="token operator">-</span>temp<span class="token operator">-</span><span class="token builtin">path</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>var<span class="token operator">/</span>run<span class="token operator">/</span>nginx<span class="token operator">/</span>proxy_temp <span class="token operator">-</span><span class="token operator">-</span>http<span class="token operator">-</span>fastcgi<span class="token operator">-</span>temp<span class="token operator">-</span><span class="token builtin">path</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>var<span class="token operator">/</span>run<span class="token operator">/</span>nginx<span class="token operator">/</span>fastcgi_temp <span class="token operator">-</span><span class="token operator">-</span>http<span class="token operator">-</span>uwsgi<span class="token operator">-</span>temp<span class="token operator">-</span><span class="token builtin">path</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>var<span class="token operator">/</span>run<span class="token operator">/</span>nginx<span class="token operator">/</span>uwsgi_temp <span class="token operator">-</span><span class="token operator">-</span>http<span class="token operator">-</span>scgi<span class="token operator">-</span>temp<span class="token operator">-</span><span class="token builtin">path</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>var<span class="token operator">/</span>run<span class="token operator">/</span>nginx<span class="token operator">/</span>scgi_temp <span class="token operator">-</span><span class="token operator">-</span>http<span class="token operator">-</span>log<span class="token operator">-</span><span class="token builtin">path</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>access<span class="token operator">.</span>log <span class="token operator">-</span><span class="token operator">-</span>error<span class="token operator">-</span>log<span class="token operator">-</span><span class="token builtin">path</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>error<span class="token operator">.</span>log <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>compat <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span><span class="token builtin">debug</span> <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_addition_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_auth_request_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_dav_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_degradation_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_flv_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_gunzip_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_gzip_static_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_mp4_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_random_index_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_realip_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_secure_link_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_slice_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_ssl_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_stub_status_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_sub_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>http_v2_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>ipv6 <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>mail <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>mail_ssl_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>pcre <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>pcre<span class="token operator">-</span>jit <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>stream <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>stream_realip_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>stream_ssl_module <span class="token operator">-</span><span class="token operator">-</span>with<span class="token operator">-</span>stream_ssl_preread_module
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>--prefix=/usr/local/Cellar/nginx/1.17.3_1<br>
然后就可以打开了</p> <pre><code>    open /usr/local/Cellar/nginx/1.17.3_1  
</code></pre> <h3 id="nginx一些简单的命令"><a href="#nginx一些简单的命令" class="header-anchor">#</a> nginx一些简单的命令</h3> <p>nginx -s stop  # 关闭nginx，直接杀死进程<br>
nginx -s quit  # 平缓停止 将当前正在处理的网络请求处理完成之后关闭连接<br>
nginx -s reload  # 重新加载配置文件<br>
nginx -t  # 检查默认配置文件</p> <h3 id="基本配置与优化"><a href="#基本配置与优化" class="header-anchor">#</a> 基本配置与优化</h3> <p>配置文件默认在Nginx程序安装目录下的conf二级目录，主配置文件nginx.conf</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code># 使用的用户和组
user www www;

# 指定工作衍生进程数
worker_processes 8;

# 指定错误日志存放路径
# 错误日志记录级别可选： [debug | info | notice | warn | error |crit]
error_log logs/error.log info;

# 指定pid存放的路径
pid log/nginx.pid;

# 指定文件描述符数量
worker_rlimit_nofile 51200;

events {
	# 使用网络I/O模型，linux系统推荐采用epoll模型
	use epoll;
	
	# 允许连接数
	worker_connections 51200;
}

http {
	include		mime.types;
	defualt_type application/octet-stream;
	
	# 设置使用字符集
	# 一般在HTML代码中通过meta标签设置
	charset gb2312;
	
	server_names_hash_bucket_size 128;
	client_header_buffer_size 32k;
	large_client_header_buffers 4 32k;
	
	# 设置客户端能够上传文件大小
	client_max_body_size 8m;
	
	sendfile on;
	tcp_nopush on;
	
	keepalive_timeout 60;
	
	tcp_nodelay on;
	
	fastcgi_connect_timeout 300;
	fastcgi_send_timeout 300;
	fastcgi_read_timeout 300;
	fastcgi_buffer_size 64k;
	fastcgi_buffers 4 64k;
	fastcgi_busy_buffers_size 128k;
	fastcgi_temp_file_write_size 128k;
	
	# 开启gzip
	gzip on;
	gzip_min_length 1k;
	gzip_buffers 4 16k;
	gzip_http_version 1.1;
	gzip_comp_level 2;
	gzip_types text/plain application/x-javascript text/css application/xml;
	gzip_vary on;
	
	server {
		listen 80;
		server_name www.xxx.com xxx.com;
		index index.html index.html index.php;
		root html;
		
		# limit_conn crawler 20;
		location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$ {
			expires 30d;
		}
		location ~ .*\.(js|css)?$ {
			expires 1h;
		}
		
		log_format access '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '
			'$status $body_bytes_send &quot;$http_refrer&quot; '
			'&quot;$http_user_aget&quot; $http-x-forwarded_for';
		access_log logs/access.log access;
	}
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br></div></div><h4 id="虚拟主机配置"><a href="#虚拟主机配置" class="header-anchor">#</a> 虚拟主机配置</h4> <p>虚拟主机使用特殊的软硬件技术，把一台服务器主机分成一台台“虚拟”主机，每台虚拟主机都可以是一个独立网站，可以具有独立域名，同一台主机上的虚拟主机之间是完全独立的。</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>http {
	# 第一个虚拟主机
	server {
		# 监听端口
		listen 80;
		# 主机名称
		server_name aaa.domain.com;
		# 访问日志存放路径
		access_log logs/aaadomain.com.access.log combined;
		location / {
			# 默认首页文件，从左到右
			index index.html;
			# 网站文件存放目录
			root /data0/htdocs/aaa.domain.com;
		}
	}
	
	# 第二个虚拟主机
	server {
		# 监听端口
		listen 80;
		# 主机名称
		server_name aaa.domain.com;
		# 访问日志存放路径
		access_log logs/aaadomain.com.access.log combined;
		location / {
			# 默认首页文件，从左到右
			index index.html;
			# 网站文件存放目录
			root /data0/htdocs/aaa.domain.com;
		}
	}
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h4 id="日志配置与切割"><a href="#日志配置与切割" class="header-anchor">#</a> 日志配置与切割</h4> <p>与Nginx日志相关指令主要有两条，一条是log_format，用于设置日志格式；另一条是access_log，用来指定日志文件存放路径、格式和缓存大小。这两条指令可以在Nginx配置文件中的位置可以在http之间也可以在server之间。</p> <ul><li><p>log_format</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>log_format name format [format ...]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中 name 表示定义的格式名称，format 表示定义的格式样式。</p></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>log_format mylogformat '$http_x_forwarded_for - $remote_user [$time_local] '
	'&quot;$request&quot; $status $body_byte_sent '
	'&quot;$http_referer&quot; &quot;$http_user_agent&quot;';
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><p>access_log</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>access_log path [format [buffer=size | off]]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中path表示日志文件存放路径，format 表示使用log_format指令设置的日志格式名称，buffer=size 表示设置内存缓冲区大小，如果不想记录日志，可以关闭日志 <code>access_log off;</code></p></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code># 使用自定义日志格式
access_log log/filename.log mylogformat buffer=32k; 
# Nginx 0.7.4 之后 access_log指令中可以包含变量
access_log log/$server_name.log mylogformat;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>如果日志文件中含有变量：</p> <ol><li><p>Nginx进程设置的用户和组必须由对该路径创建文件的权限。</p></li> <li><p>缓冲区将不会被使用。</p></li> <li><p>对于每一条日志记录，日志文件将先打开文件，再写入日志，然后马上关闭。为了提高包含变量日志文件存放路径性能，须使用open_log_file_cache指令设置经常呗使用日志文件描述符缓存。</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>open_log_file_cache max=1000 inactive=20s min_uses=2 valid=1m;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ol></blockquote> <ul><li><p>日志文件切割</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code># 先通过mv命令重命名日志文件
mv logs/access.log /logs/20200312.log
# 然后发送kill -USER1信号给主进程，让Nginx重新生成一个新的日志文件
# kill -USE1 Nginx主进程号
kill -USR1 `cat /usr/local/nginx/logs/nginx.pid` # 注意不是USER1 而是USR1
# 重新生成新日志文件，也可以借助nginx 发送信号
ngixn -s reopen
# reopen 内部调用的就是kill命令
# 每天定时切割，须借助crontab 然后写一个 shell 脚本
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul> <h4 id="压缩输出配置"><a href="#压缩输出配置" class="header-anchor">#</a> 压缩输出配置</h4> <p>gzip是一种压缩技术。经过gzip压缩后页面大小可以变成原来的30%甚至更小。gzip压缩页面需要浏览器和服务器双方都支持，实际上就是服务端压缩，传到浏览器解压并解析。现在绝大多数浏览器都支持解析gzip过的页面。</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>	gzip on;
	gzip_min_length 1k;
	gzip_buffers 4 16k;
	gzip_http_version 1.1;
	gzip_comp_level 2;
	gzip_types text/plain application/x-javascript text/css application/xml;
	gzip_vary on;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="高级应用"><a href="#高级应用" class="header-anchor">#</a> 高级应用</h2> <h3 id="rewrite-应用"><a href="#rewrite-应用" class="header-anchor">#</a> Rewrite 应用</h3> <p>Rewrite主要功能就是实现URL重写。通过Rewrite规则，可以实现规范的URL，根据变量来做URL转向及选择配置。</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>server{
	location / {
		rewrite ^(.*).htmp$ /rewrite.html;
	}	
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>访问****.htmp重写到rewrite.html</p> <h3 id="负载均衡和反向代理"><a href="#负载均衡和反向代理" class="header-anchor">#</a> 负载均衡和反向代理</h3> <ul><li>负载均衡</li></ul> <blockquote><p>由多台服务器以对称的方式组成一个服务器集合，每台服务器都具有等价的地位，都可以单独对外提供服务而无需其它服务器的辅助。</p></blockquote> <ul><li>反向代理</li></ul> <blockquote><p>指以代理服务器来接收Internet上的连接请求，然后将请求转发给网络上的服务器，并将从该服务器得到的结果返回给Internet上请求连接的客户端，此时代理服务器对外就表现为一个服务器。</p></blockquote> <ul><li><p>负载均衡与反向代理配置</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code># 反向代理配置
# 直接配置
server {
	...
	location / {
		proxy_pass http://xxx.com;
	}
	...
}

# 通过别名配置
http {
...
upstream 别名 {
	server ip:端口;
}
server {
	...
	location / {
		proxy_pass http://别名;
	}
	...
}
...
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-text"><code> server{
    # 端口
    listen 440;
    # 主机名 域名
    server_name aaa.domain.com;
    #需要做本机配置映射
    #vim /etc/hosts  
    #127.0.0.1 aaa.domain.com


    #日志文件存放配置
    #access_log logs/aaa.domain.com.access.log combined;
    location / {
      index index.html index.php;
      root html/;
    }
    # 转发
    location /api/ {
      proxy_pass http://www.e21.cn/;
    }

  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code># 负载均衡
# 别名中可以放多个server 
# nginx 可以进行简单轮巡

http {
...
upstream 别名 {
	server ip:端口;
	server ip:端口;
	
}
server {
	...
	location / {
		proxy_pass http://别名;
	}
	...
}
...
}
```

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/blog/guide/nodeCode/2.html">Node原理 基础API以及搭建静态服务器</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.691678be.js" defer></script><script src="/blog/assets/js/2.ba034f29.js" defer></script><script src="/blog/assets/js/50.acb96b49.js" defer></script>
  </body>
</html>
